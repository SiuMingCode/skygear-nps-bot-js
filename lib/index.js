'use strict';

const skygearCloud = require('skygear/cloud');
const { DEVELOPMENT_MODE } = require('./config');
const { executeScheduledTasks, handleOAuth, handleCommand, handleAction, handleEvent } = require('./handlers');

/**
 * Check availability after a git push
 */
skygearCloud.handler('ping', req => 'Hello, world\n', {
  method: ['GET'],
  userRequired: false
});

/**
 * Test any new feature here
 */
skygearCloud.handler('dev', req => {}, {
  method: ['GET'],
  userRequired: false
});

let interval = DEVELOPMENT_MODE ? '*/15 * * * * *' : '0 0 10 * * *'; // at every 15s of every m: at 10:00 of every day
skygearCloud.every(interval, executeScheduledTasks);

skygearCloud.handler('oauth', handleOAuth, {
  method: ['GET'],
  userRequired: false
});

skygearCloud.handler('command', handleCommand, {
  method: ['POST'],
  userRequired: false
});

skygearCloud.handler('action', handleAction, {
  method: ['POST'],
  userRequired: false
});

skygearCloud.handler('event', handleEvent, {
  method: ['POST'],
  userRequired: false
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJza3lnZWFyQ2xvdWQiLCJyZXF1aXJlIiwiREVWRUxPUE1FTlRfTU9ERSIsImV4ZWN1dGVTY2hlZHVsZWRUYXNrcyIsImhhbmRsZU9BdXRoIiwiaGFuZGxlQ29tbWFuZCIsImhhbmRsZUFjdGlvbiIsImhhbmRsZUV2ZW50IiwiaGFuZGxlciIsInJlcSIsIm1ldGhvZCIsInVzZXJSZXF1aXJlZCIsImludGVydmFsIiwiZXZlcnkiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsZUFBZUMsUUFBUSxlQUFSLENBQXJCO0FBQ0EsTUFBTSxFQUFFQyxnQkFBRixLQUF1QkQsUUFBUSxVQUFSLENBQTdCO0FBQ0EsTUFBTSxFQUFFRSxxQkFBRixFQUF5QkMsV0FBekIsRUFBc0NDLGFBQXRDLEVBQXFEQyxZQUFyRCxFQUFtRUMsV0FBbkUsS0FBbUZOLFFBQVEsWUFBUixDQUF6Rjs7QUFFQTs7O0FBR0FELGFBQWFRLE9BQWIsQ0FBcUIsTUFBckIsRUFBNkJDLE9BQU8sZ0JBQXBDLEVBQXNEO0FBQ3BEQyxVQUFRLENBQUMsS0FBRCxDQUQ0QztBQUVwREMsZ0JBQWM7QUFGc0MsQ0FBdEQ7O0FBS0E7OztBQUdBWCxhQUFhUSxPQUFiLENBQXFCLEtBQXJCLEVBQTRCQyxPQUFPLENBRWxDLENBRkQsRUFFRztBQUNEQyxVQUFRLENBQUMsS0FBRCxDQURQO0FBRURDLGdCQUFjO0FBRmIsQ0FGSDs7QUFPQSxJQUFJQyxXQUFXVixtQkFBbUIsZ0JBQW5CLEdBQXNDLGNBQXJELEMsQ0FBb0U7QUFDcEVGLGFBQWFhLEtBQWIsQ0FBbUJELFFBQW5CLEVBQTZCVCxxQkFBN0I7O0FBRUFILGFBQWFRLE9BQWIsQ0FBcUIsT0FBckIsRUFBOEJKLFdBQTlCLEVBQTJDO0FBQ3pDTSxVQUFRLENBQUMsS0FBRCxDQURpQztBQUV6Q0MsZ0JBQWM7QUFGMkIsQ0FBM0M7O0FBS0FYLGFBQWFRLE9BQWIsQ0FBcUIsU0FBckIsRUFBZ0NILGFBQWhDLEVBQStDO0FBQzdDSyxVQUFRLENBQUMsTUFBRCxDQURxQztBQUU3Q0MsZ0JBQWM7QUFGK0IsQ0FBL0M7O0FBS0FYLGFBQWFRLE9BQWIsQ0FBcUIsUUFBckIsRUFBK0JGLFlBQS9CLEVBQTZDO0FBQzNDSSxVQUFRLENBQUMsTUFBRCxDQURtQztBQUUzQ0MsZ0JBQWM7QUFGNkIsQ0FBN0M7O0FBS0FYLGFBQWFRLE9BQWIsQ0FBcUIsT0FBckIsRUFBOEJELFdBQTlCLEVBQTJDO0FBQ3pDRyxVQUFRLENBQUMsTUFBRCxDQURpQztBQUV6Q0MsZ0JBQWM7QUFGMkIsQ0FBM0MiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBza3lnZWFyQ2xvdWQgPSByZXF1aXJlKCdza3lnZWFyL2Nsb3VkJylcbmNvbnN0IHsgREVWRUxPUE1FTlRfTU9ERSB9ID0gcmVxdWlyZSgnLi9jb25maWcnKVxuY29uc3QgeyBleGVjdXRlU2NoZWR1bGVkVGFza3MsIGhhbmRsZU9BdXRoLCBoYW5kbGVDb21tYW5kLCBoYW5kbGVBY3Rpb24sIGhhbmRsZUV2ZW50IH0gPSByZXF1aXJlKCcuL2hhbmRsZXJzJylcblxuLyoqXG4gKiBDaGVjayBhdmFpbGFiaWxpdHkgYWZ0ZXIgYSBnaXQgcHVzaFxuICovXG5za3lnZWFyQ2xvdWQuaGFuZGxlcigncGluZycsIHJlcSA9PiAnSGVsbG8sIHdvcmxkXFxuJywge1xuICBtZXRob2Q6IFsnR0VUJ10sXG4gIHVzZXJSZXF1aXJlZDogZmFsc2Vcbn0pXG5cbi8qKlxuICogVGVzdCBhbnkgbmV3IGZlYXR1cmUgaGVyZVxuICovXG5za3lnZWFyQ2xvdWQuaGFuZGxlcignZGV2JywgcmVxID0+IHtcblxufSwge1xuICBtZXRob2Q6IFsnR0VUJ10sXG4gIHVzZXJSZXF1aXJlZDogZmFsc2Vcbn0pXG5cbmxldCBpbnRlcnZhbCA9IERFVkVMT1BNRU5UX01PREUgPyAnKi8xNSAqICogKiAqIConIDogJzAgMCAxMCAqICogKicgLy8gYXQgZXZlcnkgMTVzIG9mIGV2ZXJ5IG06IGF0IDEwOjAwIG9mIGV2ZXJ5IGRheVxuc2t5Z2VhckNsb3VkLmV2ZXJ5KGludGVydmFsLCBleGVjdXRlU2NoZWR1bGVkVGFza3MpXG5cbnNreWdlYXJDbG91ZC5oYW5kbGVyKCdvYXV0aCcsIGhhbmRsZU9BdXRoLCB7XG4gIG1ldGhvZDogWydHRVQnXSxcbiAgdXNlclJlcXVpcmVkOiBmYWxzZVxufSlcblxuc2t5Z2VhckNsb3VkLmhhbmRsZXIoJ2NvbW1hbmQnLCBoYW5kbGVDb21tYW5kLCB7XG4gIG1ldGhvZDogWydQT1NUJ10sXG4gIHVzZXJSZXF1aXJlZDogZmFsc2Vcbn0pXG5cbnNreWdlYXJDbG91ZC5oYW5kbGVyKCdhY3Rpb24nLCBoYW5kbGVBY3Rpb24sIHtcbiAgbWV0aG9kOiBbJ1BPU1QnXSxcbiAgdXNlclJlcXVpcmVkOiBmYWxzZVxufSlcblxuc2t5Z2VhckNsb3VkLmhhbmRsZXIoJ2V2ZW50JywgaGFuZGxlRXZlbnQsIHtcbiAgbWV0aG9kOiBbJ1BPU1QnXSxcbiAgdXNlclJlcXVpcmVkOiBmYWxzZVxufSlcbiJdfQ==