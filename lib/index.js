'use strict';

const skygearCloud = require('skygear/cloud');
const { DEVELOPMENT_MODE } = require('./config');
const { distributeScheduledSurveys, handleOAuth, handleCommand, handleAction, handleEvent } = require('./handlers');

/**
 * Check availability after a git push
 */
skygearCloud.handler('ping', req => 'Hello, world\n', {
  method: ['GET'],
  userRequired: false
});

/**
 * Test any new feature here
 */
skygearCloud.handler('dev', req => {}, {
  method: ['GET'],
  userRequired: false
});

let interval = DEVELOPMENT_MODE ? '@every 10s' : '@daily';
skygearCloud.every(interval, distributeScheduledSurveys);

skygearCloud.handler('oauth', handleOAuth, {
  method: ['GET'],
  userRequired: false
});

skygearCloud.handler('command', handleCommand, {
  method: ['POST'],
  userRequired: false
});

skygearCloud.handler('action', handleAction, {
  method: ['POST'],
  userRequired: false
});

skygearCloud.handler('event', handleEvent, {
  method: ['POST'],
  userRequired: false
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJza3lnZWFyQ2xvdWQiLCJyZXF1aXJlIiwiREVWRUxPUE1FTlRfTU9ERSIsImRpc3RyaWJ1dGVTY2hlZHVsZWRTdXJ2ZXlzIiwiaGFuZGxlT0F1dGgiLCJoYW5kbGVDb21tYW5kIiwiaGFuZGxlQWN0aW9uIiwiaGFuZGxlRXZlbnQiLCJoYW5kbGVyIiwicmVxIiwibWV0aG9kIiwidXNlclJlcXVpcmVkIiwiaW50ZXJ2YWwiLCJldmVyeSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxlQUFlQyxRQUFRLGVBQVIsQ0FBckI7QUFDQSxNQUFNLEVBQUVDLGdCQUFGLEtBQXVCRCxRQUFRLFVBQVIsQ0FBN0I7QUFDQSxNQUFNLEVBQUVFLDBCQUFGLEVBQThCQyxXQUE5QixFQUEyQ0MsYUFBM0MsRUFBMERDLFlBQTFELEVBQXdFQyxXQUF4RSxLQUF3Rk4sUUFBUSxZQUFSLENBQTlGOztBQUVBOzs7QUFHQUQsYUFBYVEsT0FBYixDQUFxQixNQUFyQixFQUE2QkMsT0FBTyxnQkFBcEMsRUFBc0Q7QUFDcERDLFVBQVEsQ0FBQyxLQUFELENBRDRDO0FBRXBEQyxnQkFBYztBQUZzQyxDQUF0RDs7QUFLQTs7O0FBR0FYLGFBQWFRLE9BQWIsQ0FBcUIsS0FBckIsRUFBNEJDLE9BQU8sQ0FFbEMsQ0FGRCxFQUVHO0FBQ0RDLFVBQVEsQ0FBQyxLQUFELENBRFA7QUFFREMsZ0JBQWM7QUFGYixDQUZIOztBQU9BLElBQUlDLFdBQVdWLG1CQUFtQixZQUFuQixHQUFrQyxRQUFqRDtBQUNBRixhQUFhYSxLQUFiLENBQW1CRCxRQUFuQixFQUE2QlQsMEJBQTdCOztBQUVBSCxhQUFhUSxPQUFiLENBQXFCLE9BQXJCLEVBQThCSixXQUE5QixFQUEyQztBQUN6Q00sVUFBUSxDQUFDLEtBQUQsQ0FEaUM7QUFFekNDLGdCQUFjO0FBRjJCLENBQTNDOztBQUtBWCxhQUFhUSxPQUFiLENBQXFCLFNBQXJCLEVBQWdDSCxhQUFoQyxFQUErQztBQUM3Q0ssVUFBUSxDQUFDLE1BQUQsQ0FEcUM7QUFFN0NDLGdCQUFjO0FBRitCLENBQS9DOztBQUtBWCxhQUFhUSxPQUFiLENBQXFCLFFBQXJCLEVBQStCRixZQUEvQixFQUE2QztBQUMzQ0ksVUFBUSxDQUFDLE1BQUQsQ0FEbUM7QUFFM0NDLGdCQUFjO0FBRjZCLENBQTdDOztBQUtBWCxhQUFhUSxPQUFiLENBQXFCLE9BQXJCLEVBQThCRCxXQUE5QixFQUEyQztBQUN6Q0csVUFBUSxDQUFDLE1BQUQsQ0FEaUM7QUFFekNDLGdCQUFjO0FBRjJCLENBQTNDIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2t5Z2VhckNsb3VkID0gcmVxdWlyZSgnc2t5Z2Vhci9jbG91ZCcpXG5jb25zdCB7IERFVkVMT1BNRU5UX01PREUgfSA9IHJlcXVpcmUoJy4vY29uZmlnJylcbmNvbnN0IHsgZGlzdHJpYnV0ZVNjaGVkdWxlZFN1cnZleXMsIGhhbmRsZU9BdXRoLCBoYW5kbGVDb21tYW5kLCBoYW5kbGVBY3Rpb24sIGhhbmRsZUV2ZW50IH0gPSByZXF1aXJlKCcuL2hhbmRsZXJzJylcblxuLyoqXG4gKiBDaGVjayBhdmFpbGFiaWxpdHkgYWZ0ZXIgYSBnaXQgcHVzaFxuICovXG5za3lnZWFyQ2xvdWQuaGFuZGxlcigncGluZycsIHJlcSA9PiAnSGVsbG8sIHdvcmxkXFxuJywge1xuICBtZXRob2Q6IFsnR0VUJ10sXG4gIHVzZXJSZXF1aXJlZDogZmFsc2Vcbn0pXG5cbi8qKlxuICogVGVzdCBhbnkgbmV3IGZlYXR1cmUgaGVyZVxuICovXG5za3lnZWFyQ2xvdWQuaGFuZGxlcignZGV2JywgcmVxID0+IHtcblxufSwge1xuICBtZXRob2Q6IFsnR0VUJ10sXG4gIHVzZXJSZXF1aXJlZDogZmFsc2Vcbn0pXG5cbmxldCBpbnRlcnZhbCA9IERFVkVMT1BNRU5UX01PREUgPyAnQGV2ZXJ5IDEwcycgOiAnQGRhaWx5J1xuc2t5Z2VhckNsb3VkLmV2ZXJ5KGludGVydmFsLCBkaXN0cmlidXRlU2NoZWR1bGVkU3VydmV5cylcblxuc2t5Z2VhckNsb3VkLmhhbmRsZXIoJ29hdXRoJywgaGFuZGxlT0F1dGgsIHtcbiAgbWV0aG9kOiBbJ0dFVCddLFxuICB1c2VyUmVxdWlyZWQ6IGZhbHNlXG59KVxuXG5za3lnZWFyQ2xvdWQuaGFuZGxlcignY29tbWFuZCcsIGhhbmRsZUNvbW1hbmQsIHtcbiAgbWV0aG9kOiBbJ1BPU1QnXSxcbiAgdXNlclJlcXVpcmVkOiBmYWxzZVxufSlcblxuc2t5Z2VhckNsb3VkLmhhbmRsZXIoJ2FjdGlvbicsIGhhbmRsZUFjdGlvbiwge1xuICBtZXRob2Q6IFsnUE9TVCddLFxuICB1c2VyUmVxdWlyZWQ6IGZhbHNlXG59KVxuXG5za3lnZWFyQ2xvdWQuaGFuZGxlcignZXZlbnQnLCBoYW5kbGVFdmVudCwge1xuICBtZXRob2Q6IFsnUE9TVCddLFxuICB1c2VyUmVxdWlyZWQ6IGZhbHNlXG59KVxuIl19